<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Ace test</title>
	<script src="/##public##/bootstrap/jquery-2.2.0.min.js"></script>
	<script src="/##public##/ace/ace.js"></script>
	<script src="/##public##/bootstrap/bootstrap.min.js"></script>
	<style src="/##public##/bootstrap/bootstrap.min.css"></style>
	<style>
	#editor { 
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
	}
	</style>
</head>
<body>
	<div id="editor"></div>
	<script>
	var editor = ace.edit("editor");
	editor.setTheme("ace/theme/##theme##");
	editor.getSession().setMode("ace/mode/##edit##",function(){
		$.get(window.location.origin+window.location.pathname, function(data){		
			console.log('got',data);
			var content;
			if (editor.getSession().getMode().$id=="ace/mode/xml"){
				content = new XMLSerializer().serializeToString(data);
			} else {
				content = data;
			}
			editor.setValue(content);
		});
	});
	editor.commands.addCommand({
		name: 'save',
		bindKey: {win: 'Ctrl-S',  mac: 'Command-S'},
		exec: function(editor) {
			console.log('saving folder');
			$.post(window.location, {data: editor.getValue()}, function(data) {
				console.log(data);
			});
		},
		readOnly: false 
	});
	</script>
</body>
</html>