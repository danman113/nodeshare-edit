<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Ace test</title>
	<script src="/##public##/bootstrap/jquery-2.2.0.min.js"></script>
	<script src="/##public##/ace/ace.js"></script>
	<script src="/##public##/bootstrap/bootstrap.min.js"></script>
	<style src="/##public##/bootstrap/bootstrap.min.css"></style>
	<style>
	#editor { 
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
	}
	</style>
</head>
<body>
	<div id="editor"></div>
	<script>
	var editor = ace.edit("editor");
	editor.setTheme("ace/theme/##theme##");
	editor.getSession().setMode("ace/mode/##edit##",function(){
		$.get({
			url:window.location.origin+window.location.pathname,
			success:function(data){
				appendToEditor(data);
			}, error:function(e){
				appendToEditor(e.responseText);
			}
		});
	});
	editor.commands.addCommand({
		name: 'save',
		bindKey: {win: 'Ctrl-S',  mac: 'Command-S'},
		exec: function(editor) {
			console.log('saving folder');
			$.post(window.location, {data: editor.getValue()}, function(data) {
				console.log(data);
			});
		},
		readOnly: false 
	});

	function appendToEditor(data){
		var content;
		if (editor.getSession().getMode().$id=="ace/mode/xml"){
			content = new XMLSerializer().serializeToString(data);
		} else if(editor.getSession().getMode().$id=="ace/mode/json"){
			content = JSON.stringify(data);
		} else {
			content = data;
		}
		editor.setValue(content);
	}
	</script>
</body>
</html>